const COLS = 10;
const ROWS = 7;
const BLOCK_SIZE = 40; // pixels
const DROP_INTERVAL = 1000; // ms
const TOTAL_TIME = 5 * 60 * 1000; // 5 minutes in ms

// Integer-based letter frequency mapping
const letterFrequency = {
    A : [208, 4432, 6940, 5055, 2192, 1278, 4510, 1090, 4185, 251, 2064, 13843, 6052, 18310, 260, 4145, 204, 15452, 8544, 12208, 2810, 2168, 1610, 780, 2142, 1030],
    B : [5406, 1232, 106, 157, 5389, 60, 38, 129, 3661, 61, 29, 4042, 78, 65, 4266, 53, 1, 2874, 628, 199, 2683, 54, 63, 1, 438, 7],
    C : [8156, 15, 825, 30, 4989, 6, 5, 8559, 3751, 0, 4490, 2364, 33, 73, 8386, 22, 59, 3259, 489, 2549, 3114, 1, 9, 1, 1289, 32],
    D : [4190, 245, 110, 1279, 9497, 193, 694, 294, 7099, 135, 27, 1506, 268, 222, 3920, 112, 3, 2155, 2043, 77, 1821, 114, 362, 1, 969, 31],
    E : [7362, 1661, 4228, 15429, 4949, 1644, 1874, 626, 2092, 204, 531, 9179, 4403, 13288, 1420, 3045, 299, 27768, 20048, 7894, 1451, 1583, 1649, 1844, 1396, 302],
    F : [2081, 36, 21, 35, 2295, 1717, 18, 18, 3117, 8, 8, 2228, 27, 23, 2730, 15, 0, 1446, 270, 791, 2019, 0, 37, 2, 570, 2],
    G : [4107, 151, 27, 74, 5945, 79, 1350, 1497, 2954, 10, 25, 2380, 316, 894, 2556, 51, 0, 2735, 1367, 108, 2067, 3, 162, 0, 875, 6],
    H : [6699, 128, 47, 65, 7952, 102, 37, 49, 5589, 8, 50, 672, 352, 222, 5507, 72, 1, 1129, 568, 936, 1719, 18, 215, 0, 1740, 14],
    I : [7590, 1518, 10060, 6615, 7445, 2218, 3085, 162, 270, 90, 1651, 7430, 3600, 25379, 3839, 2629, 232, 3947, 13022, 9290, 1022, 2132, 107, 494, 76, 2041],
    J : [1055, 1, 2, 8, 627, 0, 1, 8, 372, 6, 2, 2, 3, 8, 748, 3, 0, 8, 2, 2, 775, 1, 2, 0, 7, 0],
    K : [1717, 170, 44, 48, 5165, 117, 12, 343, 3043, 11, 106, 836, 138, 491, 818, 84, 1, 284, 1341, 154, 423, 28, 215, 1, 555, 3],
    L : [10989, 411, 560, 1422, 16247, 536, 404, 130, 12708, 17, 655, 7234, 679, 143, 7570, 608, 12, 114, 2297, 1624, 3426, 532, 186, 6, 5413, 44],
    M : [8773, 2245, 49, 57, 7519, 103, 18, 51, 6876, 9, 27, 265, 1424, 392, 4740, 2680, 5, 90, 1386, 68, 1963, 22, 63, 0, 1106, 13],
    N : [6475, 663, 3785, 5960, 11372, 1133, 12868, 599, 8276, 261, 1575, 835, 440, 2006, 5074, 537, 126, 590, 5433, 8107, 1661, 511, 555, 56, 1082, 251],
    O : [1913, 1813, 3497, 3540, 1305, 934, 2710, 353, 3069, 81, 1295, 7290, 5227, 12757, 5122, 4035, 105, 11643, 5800, 5531, 7002, 2193, 3031, 954, 770, 468],
    P : [5597, 149, 124, 73, 6584, 111, 55, 3158, 5219, 19, 42, 3033, 114, 158, 4899, 1733, 3, 4173, 1682, 1329, 2034, 6, 142, 0, 785, 1],
    Q : [19, 0, 0, 1, 4, 1, 0, 1, 17, 0, 0, 1, 0, 1, 4, 1, 2, 4, 3, 1, 2591, 0, 2, 0, 0, 0],
    R : [12816, 1320, 1724, 2966, 17161, 570, 1479, 646, 13640, 65, 1368, 1385, 2318, 2117, 10300, 927, 72, 2409, 6541, 3399, 3451, 673, 377, 7, 3278, 85],
    S : [4582, 227, 3438, 111, 9766, 136, 121, 6666, 6161, 36, 1366, 1583, 2987, 840, 4039, 3412, 463, 134, 5912, 13358, 3285, 51, 932, 0, 1079, 16],
    T : [8723, 329, 1006, 118, 17516, 355, 123, 5649, 11548, 49, 49, 1652, 342, 214, 7408, 185, 9, 6105, 3894, 3312, 3228, 51, 775, 2, 2478, 271],
    U : [1775, 2051, 2233, 1614, 1980, 628, 1403, 76, 1919, 73, 442, 5726, 4432, 9894, 355, 2079, 25, 6919, 7046, 4752, 55, 276, 29, 253, 113, 246],
    V : [2326, 0, 5, 8, 6443, 0, 5, 1, 3149, 0, 6, 16, 2, 12, 1229, 2, 0, 78, 18, 5, 248, 40, 2, 0, 116, 4],     
    W : [3504, 170, 49, 183, 2328, 89, 39, 1036, 2484, 2, 155, 446, 97, 731, 2152, 77, 2, 458, 560, 130, 82, 2, 53, 0, 132, 18],
    X : [429, 35, 202, 7, 675, 28, 10, 74, 996, 0, 1, 44, 29, 2, 372, 248, 2, 10, 58, 360, 115, 4, 34, 4, 323, 0],
    Y : [1373, 269, 609, 390, 1192, 128, 300, 94, 749, 8, 63, 1498, 914, 804, 823, 992, 2, 869, 1458, 682, 163, 29, 200, 97, 8, 93],
    Z : [725, 14, 11, 15, 2463, 2, 9, 11, 883, 2, 8, 202, 11, 9, 957, 11, 4, 9, 8, 10, 116, 5, 13, 0, 256, 448]
};

const letterSum = {
    A : 132223, B : 32237, C : 57155, D : 55542, E : 166491, F : 20264, G: 38605, H : 38390, I : 118718, J : 3661, K : 19216, L : 82413, M : 45101, 
    N : 93335, O : 95566, P : 42874, Q : 2664, R : 104486, S : 112377, T : 88091, U : 57101, V : 13800, W : 15782, X : 4755, Y : 27954, Z : 6412
}

const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
const MAX_FREQ = 50000;

const letterScore = {
    A: 2, B: 8, C: 7, D: 7, E: 0, F: 9, G: 8, H: 8, I: 2, J: 10, K: 9, L: 5, M: 7,
    N: 4, O: 4, P: 8, Q: 10, R: 3, S: 3, T: 5, U: 7, V: 10, W: 9, X: 10, Y: 9, Z: 10
};